<!DOCTYPE html>
<html>
<head>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body { font-family: Arial; background: linear-gradient(#667eea 0%, #764ba2 100%); color: white; text-align: center; padding: 20px; }
        #dice { font-size: 100px; margin: 20px; transition: transform 0.5s; }
        #coins { font-size: 48px; margin: 20px; }
        button { background: #00ff88; border: none; padding: 15px 30px; font-size: 24px; border-radius: 10px; margin: 10px; cursor: pointer; }
        button:disabled { background: #ccc; }
        #board { display: flex; justify-content: center; flex-wrap: wrap; max-width: 600px; margin: 20px auto; }
        .slot { width: 80px; height: 80px; background: #ffdd44; margin: 5px; border-radius: 10px; display: flex; align-items: center; justify-content: center; font-weight: bold; }
    </style>
</head>
<body>
    <h1>üçÄ –ë—Ä–æ—Å–∫–∏ –ö—É–±–∏–∫–æ–≤ üçÄ</h1>
    <div id="coins">–ú–æ–Ω–µ—Ç—ã: 0</div>
    <div id="dice">üé≤</div>
    <button id="rollBtn">–ö—Ä—É—Ç–∏—Ç—å! (5/5)</button>
    <button id="adBtn">üì∫ –†–µ–∫–ª–∞–º–∞ –∑–∞ +3 –∫—Ä—É—Ç–∫–∏</button>
    <button id="upgradeBtn">–£–ª—É—á—à–∏—Ç—å —Å–ª–æ—Ç (1K –º–æ–Ω–µ—Ç)</button>
    <div id="board"></div>
    <button onclick="share()">–ü–æ–¥–µ–ª–∏—Ç—å—Å—è –ø—Ä–æ–≥—Ä–µ—Å—Å–æ–º</button>

    <script>
        let coins = 0, rollsLeft = 5, multipliers = [1,1,1,1,1]; // 5 —Å–ª–æ—Ç–æ–≤ –Ω–∞ —Å—Ç–∞—Ä—Ç–µ
        const tg = window.Telegram.WebApp; tg.initDataUnsafe = tg.initDataUnsafe || {}; tg.ready();
        tg.expand(); tg.MainButton.text = '–ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π –±–æ–Ω—É—Å'; tg.MainButton.onClick(claimDaily);

        function updateUI() {
            document.getElementById('coins').textContent = `–ú–æ–Ω–µ—Ç—ã: ${coins}`;
            document.getElementById('rollBtn').textContent = `–ö—Ä—É—Ç–∏—Ç—å! (${rollsLeft}/5)`; 
            document.getElementById('rollBtn').disabled = rollsLeft <= 0;
            document.getElementById('upgradeBtn').disabled = coins < 1000;
            updateBoard();
        }

        function roll() {
            if (rollsLeft <= 0) return;
            tg.HapticFeedback.impactOccurred('light'); // –í–∏–±—Ä–∞—Ü–∏—è
            document.getElementById('dice').style.transform = 'rotate(360deg) scale(1.2)';
            setTimeout(() => {
                const steps = Math.floor(Math.random() * 6) + 1;
                let reward = steps * multipliers[0]; // –ü–µ—Ä–≤—ã–π —Å–ª–æ—Ç
                coins += reward;
                alert(`üéâ –í—ã–ø–∞–ª–æ ${steps}! +${reward} –º–æ–Ω–µ—Ç!`); // –í TG ‚Äî tg.showAlert
                rollsLeft--;
                updateUI();
                saveProgress(); // Firebase call
            }, 500);
        }

        function updateBoard() {
            const board = document.getElementById('board');
            board.innerHTML = multipliers.map(m => `<div class="slot">x${m}</div>`).join('');
        }

        function upgrade() {
            if (coins >= 1000) {
                coins -= 1000;
                multipliers[0] *= 1.5;
                tg.showAlert('–°–ª–æ—Ç —É–ª—É—á—à–µ–Ω! üöÄ');
                updateUI();
            }
        }

        function claimDaily() { coins += 500; tg.showAlert('–ï–∂–µ–¥–Ω–µ–≤–∫–∞: +500!'); updateUI(); }

        function share() { tg.shareUrl(tg.initDataUnsafe.start_app || window.location.href, `–£ –º–µ–Ω—è ${coins} –º–æ–Ω–µ—Ç! –ü—Ä–∏—Å–æ–µ–¥–∏–Ω—è–π—Å—è!`); }

        // –°–∏–º—É–ª—è—Ü–∏—è save (–≤ —Ä–µ–∞–ª–µ ‚Äî fetch('/save', {user_id: tg.initDataUnsafe.user.id, coins}))
        function saveProgress() { console.log('–°–æ—Ö—Ä–∞–Ω–µ–Ω–æ:', coins); }

        document.getElementById('rollBtn').onclick = roll;
        document.getElementById('adBtn').onclick = () => { rollsLeft += 3; tg.showAlert('–†–µ–∫–ª–∞–º–∞ –ø—Ä–æ—Å–º–æ—Ç—Ä–µ–Ω–∞! +3'); updateUI(); }; // –ó–∞–≥–ª—É—à–∫–∞
        document.getElementById('upgradeBtn').onclick = upgrade;
        updateUI();
    </script>
</body>
</html>